# 315.Count-of-Smaller-Numbers-After-Self

大致有兩種思路，一種是在二叉樹後序遍歷時，利用兩個數組有序的性質搭配二分法累加後面比當前的數字要小的數。另一種是用樹狀數組動態計算區間和。

- 分治法

```
[X X X X X  X X X X X X]

[Y Y Y Y Y][Z Z Z Z Z Z]
```

要算後面有幾個更小的數，可以拆分為兩個小數組各自計算，再合併為大數組。後半部分的數組計算完後，後面不可能再有更小的數字，因此可直接併入大數組，前半部分數組少考慮後半部分數組中比自己小的元素總數，歸併排序讓後半部分數組有序，可以用二分法搜出比自己小的元素個數再累加，題目要求嚴格小於當前數字，所以要搜第一個大於等於當前數字的數所在位置並計算偏移量，累加完後才能併入大數組。

- 樹狀數組

數組固定不變時，可以預計算前綴和數組來應對頻繁的區間和查詢。不過當數組頻繁更新時，前綴和數組也要頻繁重新計算，導致效率降低。此時樹狀數組是應對動態查詢區間和最簡單有效的數據結構。數組索引必為正數，數據範圍為[-10000:10000]不能直接適用，可將數據範圍調整為[1:20001]。

