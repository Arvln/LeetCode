# 918.Maximum-Sum-Circular-Subarray

求環形子數組最大和，有兩種很容易想到的思路，一種是用來求子數組和的前綴和數組，一種是用來求最大子數組和的Kadane's。

- presum+deque

求環形數組和，可以想像將原數組擴大為兩倍並預計算出前綴和數組，接著遍歷前綴和數組，找出所有長度小於等於原數組長度n的子數組和求其中的最大值。假設當前遍歷到第i位前綴和，要找到前面第j位前綴和，使[j,i)區間長度小於等於n且j對應的前綴和越小越好，如此一來[j,1)區間和將會越大，越有可能是最終結果的候選。

```
X X X [j X X] i

j>=max(0, i-n) -> sum[j, i) = pre[i]-pre[j]
max { sum[j, i) } for i=1,1,..,n
```

要找出j可以遍歷一遍i-n,i-n+1,..,i-1找出其中最小的前綴和，不過這樣會導致算法時間複雜度降為n^2，可能會TLE。回顧 #239 要求滑動窗口的最大值，可以用雙端隊列來實現，在這邊要維護的是i-n,i-n+1,..,i-1窗口中的最小值，道理也類似。隊列內存的是前綴和數組索引，當隊列頂端索引跟當前索引距離超過n，代表區間長度過大要彈出來，當隊列尾部索引指向的前綴和大於等於當前索引指向的前綴和，代表就算跟未來某個前綴和配對，相較於當前元素，它可以算出的區間和一定更小或相等，既然沒用就要彈出來，保持隊列的單調遞增特性，最後要特別注意前綴和計算需要一個虛擬頭，所以雙端隊列初始要放入一個零，避免隊列可能為空。

- Kadane's

需要分情況討論，一種是最大子數組和出現在數組中間，一種是最大子數組和出現在數組兩側。第一種情況是Kadane's經典應用，跟 #53 一模一樣，第二種情況正面要推比較難，正難則反，想像一下兩側和最大不就等同數組中間和最小，那就很簡單拉，同時維護最大跟最小子數組和，最後在最大子數組和跟數組總和減去最小子數組和中挑一個大的就是答案。特別注意當數組總和等於最小子數組和，代表數組兩側為空，題目要求答案應為非空子數組和，需要特判一下。
